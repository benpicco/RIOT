From e6dfb5482b9d9cb3078be7e66ba31779a95ab14b Mon Sep 17 00:00:00 2001
From: Benjamin Valentin <benjamin.valentin@ml-pa.com>
Date: Wed, 1 Feb 2023 14:32:55 +0100
Subject: [PATCH] [PATCH 1/27] esp_hw_support: rename rtc_init

Rename `rtc_init` to `rtc_init_module` due to name conflicts with RIOT `periph/rtc` module.
---
 components/esp_hw_support/port/esp32/rtc_init.c      | 2 +-
 components/esp_hw_support/port/esp32c3/rtc_init.c    | 2 +-
 components/esp_hw_support/port/esp32h2/rtc_init.c    | 2 +-
 components/esp_hw_support/port/esp32s2/regi2c_ctrl.h | 2 +-
 components/esp_hw_support/port/esp32s2/rtc_init.c    | 2 +-
 components/esp_hw_support/port/esp32s3/rtc_init.c    | 2 +-
 components/esp_phy/test/test_phy_rtc.c               | 4 ++--
 components/esp_system/port/soc/esp32/clk.c           | 2 +-
 components/esp_system/port/soc/esp32c3/clk.c         | 2 +-
 components/esp_system/port/soc/esp32h2/clk.c         | 2 +-
 components/esp_system/port/soc/esp32s2/clk.c         | 2 +-
 components/esp_system/port/soc/esp32s3/clk.c         | 2 +-
 components/soc/esp32/include/soc/rtc.h               | 2 +-
 components/soc/esp32c3/include/soc/rtc.h             | 2 +-
 components/soc/esp32h2/include/soc/rtc.h             | 2 +-
 components/soc/esp32s2/include/soc/rtc.h             | 2 +-
 components/soc/esp32s3/include/soc/rtc.h             | 2 +-
 17 files changed, 18 insertions(+), 18 deletions(-)

diff --git a/components/esp_hw_support/port/esp32/rtc_init.c b/components/esp_hw_support/port/esp32/rtc_init.c
index e01d604477..1027784eba 100644
--- a/components/esp_hw_support/port/esp32/rtc_init.c
+++ b/components/esp_hw_support/port/esp32/rtc_init.c
@@ -15,7 +15,7 @@
 #include "soc/gpio_periph.h"
 
 
-void rtc_init(rtc_config_t cfg)
+void rtc_init_module(rtc_config_t cfg)
 {
     CLEAR_PERI_REG_MASK(RTC_CNTL_ANA_CONF_REG, RTC_CNTL_PVTMON_PU | RTC_CNTL_TXRF_I2C_PU |
             RTC_CNTL_RFRX_PBUS_PU | RTC_CNTL_CKGEN_I2C_PU | RTC_CNTL_PLL_I2C_PU);
diff --git a/components/esp_hw_support/port/esp32c3/rtc_init.c b/components/esp_hw_support/port/esp32c3/rtc_init.c
index bb1966e6fa..81854f0330 100644
--- a/components/esp_hw_support/port/esp32c3/rtc_init.c
+++ b/components/esp_hw_support/port/esp32c3/rtc_init.c
@@ -26,7 +26,7 @@ static void set_ocode_by_efuse(int calib_version);
 static void calibrate_ocode(void);
 static void set_rtc_dig_dbias(void);
 
-void rtc_init(rtc_config_t cfg)
+void rtc_init_module(rtc_config_t cfg)
 {
     REGI2C_WRITE_MASK(I2C_DIG_REG, I2C_DIG_REG_XPD_DIG_REG, 0);
     REGI2C_WRITE_MASK(I2C_DIG_REG, I2C_DIG_REG_XPD_RTC_REG, 0);
diff --git a/components/esp_hw_support/port/esp32h2/rtc_init.c b/components/esp_hw_support/port/esp32h2/rtc_init.c
index 7b684d3d3d..ff0b5f4912 100644
--- a/components/esp_hw_support/port/esp32h2/rtc_init.c
+++ b/components/esp_hw_support/port/esp32h2/rtc_init.c
@@ -27,7 +27,7 @@ void pmu_ctl(void);
 void dcdc_ctl(uint32_t mode);
 void regulator_slt(regulator_config_t regula_cfg);
 
-void rtc_init(rtc_config_t cfg)
+void rtc_init_module(rtc_config_t cfg)
 {
     CLEAR_PERI_REG_MASK(RTC_CNTL_ANA_CONF_REG, RTC_CNTL_PVTMON_PU);
     REG_SET_FIELD(RTC_CNTL_TIMER1_REG, RTC_CNTL_PLL_BUF_WAIT, cfg.pll_wait);
diff --git a/components/esp_hw_support/port/esp32s2/regi2c_ctrl.h b/components/esp_hw_support/port/esp32s2/regi2c_ctrl.h
index 49c247499a..673e40719d 100644
--- a/components/esp_hw_support/port/esp32s2/regi2c_ctrl.h
+++ b/components/esp_hw_support/port/esp32s2/regi2c_ctrl.h
@@ -35,7 +35,7 @@ uint8_t i2c_rtc_read_reg(uint8_t block, uint8_t host_id, uint8_t reg_add);
 uint8_t i2c_rtc_read_reg_mask(uint8_t block, uint8_t host_id, uint8_t reg_add, uint8_t msb, uint8_t lsb);
 void i2c_rtc_write_reg(uint8_t block, uint8_t host_id, uint8_t reg_add, uint8_t data);
 void i2c_rtc_write_reg_mask(uint8_t block, uint8_t host_id, uint8_t reg_add, uint8_t msb, uint8_t lsb, uint8_t data);
-void i2c_rtc_init(void);
+void i2c_rtc_init_module(void);
 
 #ifdef BOOTLOADER_BUILD
 
diff --git a/components/esp_hw_support/port/esp32s2/rtc_init.c b/components/esp_hw_support/port/esp32s2/rtc_init.c
index 0f446730a4..79672ac4d9 100644
--- a/components/esp_hw_support/port/esp32s2/rtc_init.c
+++ b/components/esp_hw_support/port/esp32s2/rtc_init.c
@@ -24,7 +24,7 @@ __attribute__((unused)) static const char *TAG = "rtc_init";
 static void set_ocode_by_efuse(int calib_version);
 static void calibrate_ocode(void);
 
-void rtc_init(rtc_config_t cfg)
+void rtc_init_module(rtc_config_t cfg)
 {
     CLEAR_PERI_REG_MASK(RTC_CNTL_ANA_CONF_REG, RTC_CNTL_PVTMON_PU);
     REG_SET_FIELD(RTC_CNTL_TIMER1_REG, RTC_CNTL_PLL_BUF_WAIT, cfg.pll_wait);
diff --git a/components/esp_hw_support/port/esp32s3/rtc_init.c b/components/esp_hw_support/port/esp32s3/rtc_init.c
index 844c508a62..df4f754ec5 100644
--- a/components/esp_hw_support/port/esp32s3/rtc_init.c
+++ b/components/esp_hw_support/port/esp32s3/rtc_init.c
@@ -38,7 +38,7 @@ uint32_t g_rtc_dbias_pvt_240m = 28;
 uint32_t g_dig_dbias_pvt_non_240m = 27;
 uint32_t g_rtc_dbias_pvt_non_240m = 27;
 
-void rtc_init(rtc_config_t cfg)
+void rtc_init_module(rtc_config_t cfg)
 {
     REGI2C_WRITE_MASK(I2C_DIG_REG, I2C_DIG_REG_XPD_RTC_REG, 0);
     REGI2C_WRITE_MASK(I2C_DIG_REG, I2C_DIG_REG_XPD_DIG_REG, 0);
diff --git a/components/esp_phy/test/test_phy_rtc.c b/components/esp_phy/test/test_phy_rtc.c
index 5846ce8a4f..da8c95c826 100644
--- a/components/esp_phy/test/test_phy_rtc.c
+++ b/components/esp_phy/test/test_phy_rtc.c
@@ -34,7 +34,7 @@ static const char* TAG = "test_phy_rtc";
 static SemaphoreHandle_t semphr_done;
 
 //Functions in libphy.a called by WIFI or Blutooth directly in ISR
-static void test_phy_rtc_init(void)
+static void test_phy_rtc_init_module(void)
 {
     esp_err_t ret = nvs_flash_init();
     if (ret == ESP_ERR_NVS_NO_FREE_PAGES || ret == ESP_ERR_NVS_NEW_VERSION_FOUND) {
@@ -56,7 +56,7 @@ static IRAM_ATTR void test_phy_rtc_cache_task(void *arg)
     //power up wifi and bt mac bb power domain
     esp_wifi_power_domain_on();
 
-    test_phy_rtc_init();
+    test_phy_rtc_init_module();
 
 #if CONFIG_IDF_TARGET_ESP32
     extern void force_wifi_mode(int);
diff --git a/components/esp_system/port/soc/esp32/clk.c b/components/esp_system/port/soc/esp32/clk.c
index 15cdc83e06..01be12ac21 100644
--- a/components/esp_system/port/soc/esp32/clk.c
+++ b/components/esp_system/port/soc/esp32/clk.c
@@ -110,7 +110,7 @@ static void select_rtc_slow_clk(slow_clk_sel_t slow_clk)
  __attribute__((weak)) void esp_clk_init(void)
 {
     rtc_config_t cfg = RTC_CONFIG_DEFAULT();
-    rtc_init(cfg);
+    rtc_init_module(cfg);
 
 #if (CONFIG_ESP32_COMPATIBLE_PRE_V2_1_BOOTLOADERS || CONFIG_ESP32_APP_INIT_CLK)
     /* Check the bootloader set the XTAL frequency.
diff --git a/components/esp_system/port/soc/esp32c3/clk.c b/components/esp_system/port/soc/esp32c3/clk.c
index 63130015f1..a521abfc53 100644
--- a/components/esp_system/port/soc/esp32c3/clk.c
+++ b/components/esp_system/port/soc/esp32c3/clk.c
@@ -71,7 +71,7 @@ static const char *TAG = "clk";
         ) {
         cfg.cali_ocode = 1;
     }
-    rtc_init(cfg);
+    rtc_init_module(cfg);
 
     assert(rtc_clk_xtal_freq_get() == RTC_XTAL_FREQ_40M);
 
diff --git a/components/esp_system/port/soc/esp32h2/clk.c b/components/esp_system/port/soc/esp32h2/clk.c
index f6cd96be54..3a052f6cc3 100644
--- a/components/esp_system/port/soc/esp32h2/clk.c
+++ b/components/esp_system/port/soc/esp32h2/clk.c
@@ -66,7 +66,7 @@ static const char *TAG = "clk";
     if (rst_reas == RESET_REASON_CHIP_POWER_ON) {
         cfg.cali_ocode = 1;
     }
-    rtc_init(cfg);
+    rtc_init_module(cfg);
 
     assert(rtc_clk_xtal_freq_get() == RTC_XTAL_FREQ_32M);
 
diff --git a/components/esp_system/port/soc/esp32s2/clk.c b/components/esp_system/port/soc/esp32s2/clk.c
index 76012792d6..36622dfd56 100644
--- a/components/esp_system/port/soc/esp32s2/clk.c
+++ b/components/esp_system/port/soc/esp32s2/clk.c
@@ -73,7 +73,7 @@ static void select_rtc_slow_clk(slow_clk_sel_t slow_clk);
             esp_rom_uart_tx_wait_idle(CONFIG_ESP_CONSOLE_UART_NUM);
         }
     }
-    rtc_init(cfg);
+    rtc_init_module(cfg);
 
     rtc_clk_fast_freq_set(RTC_FAST_FREQ_8M);
 
diff --git a/components/esp_system/port/soc/esp32s3/clk.c b/components/esp_system/port/soc/esp32s3/clk.c
index fa0eef2114..ae658ce8a5 100644
--- a/components/esp_system/port/soc/esp32s3/clk.c
+++ b/components/esp_system/port/soc/esp32s3/clk.c
@@ -68,7 +68,7 @@ static void select_rtc_slow_clk(slow_clk_sel_t slow_clk);
     if (rst_reas == RESET_REASON_CHIP_POWER_ON) {
         cfg.cali_ocode = 1;
     }
-    rtc_init(cfg);
+    rtc_init_module(cfg);
 
     assert(rtc_clk_xtal_freq_get() == RTC_XTAL_FREQ_40M);
 
diff --git a/components/soc/esp32/include/soc/rtc.h b/components/soc/esp32/include/soc/rtc.h
index 9819fcdcf2..a85cfcea20 100644
--- a/components/soc/esp32/include/soc/rtc.h
+++ b/components/soc/esp32/include/soc/rtc.h
@@ -680,7 +680,7 @@ typedef struct rtc_config_s {
  * Initialize RTC clock and power control related functions
  * @param cfg configuration options as rtc_config_t
  */
-void rtc_init(rtc_config_t cfg);
+void rtc_init_module(rtc_config_t cfg);
 
 #define RTC_VDDSDIO_TIEH_1_8V 0 //!< TIEH field value for 1.8V VDDSDIO
 #define RTC_VDDSDIO_TIEH_3_3V 1 //!< TIEH field value for 3.3V VDDSDIO
diff --git a/components/soc/esp32c3/include/soc/rtc.h b/components/soc/esp32c3/include/soc/rtc.h
index 995b4ba922..a296d02d66 100644
--- a/components/soc/esp32c3/include/soc/rtc.h
+++ b/components/soc/esp32c3/include/soc/rtc.h
@@ -829,7 +829,7 @@ typedef struct {
  * Initialize RTC clock and power control related functions
  * @param cfg configuration options as rtc_config_t
  */
-void rtc_init(rtc_config_t cfg);
+void rtc_init_module(rtc_config_t cfg);
 
 /**
  * Structure describing vddsdio configuration
diff --git a/components/soc/esp32h2/include/soc/rtc.h b/components/soc/esp32h2/include/soc/rtc.h
index 9e187d66d5..a49d626d26 100644
--- a/components/soc/esp32h2/include/soc/rtc.h
+++ b/components/soc/esp32h2/include/soc/rtc.h
@@ -919,7 +919,7 @@ typedef struct {
 * Initialize RTC clock and power control related functions
 * @param cfg configuration options as rtc_config_t
 */
-void rtc_init(rtc_config_t cfg);
+void rtc_init_module(rtc_config_t cfg);
 
 /**
  * Structure describing vddsdio configuration
diff --git a/components/soc/esp32s2/include/soc/rtc.h b/components/soc/esp32s2/include/soc/rtc.h
index b4561a4521..84e52945f2 100644
--- a/components/soc/esp32s2/include/soc/rtc.h
+++ b/components/soc/esp32s2/include/soc/rtc.h
@@ -851,7 +851,7 @@ typedef struct {
  * Initialize RTC clock and power control related functions
  * @param cfg configuration options as rtc_config_t
  */
-void rtc_init(rtc_config_t cfg);
+void rtc_init_module(rtc_config_t cfg);
 
 /**
  * Structure describing vddsdio configuration
diff --git a/components/soc/esp32s3/include/soc/rtc.h b/components/soc/esp32s3/include/soc/rtc.h
index 977ce6e2d8..615f1e1986 100644
--- a/components/soc/esp32s3/include/soc/rtc.h
+++ b/components/soc/esp32s3/include/soc/rtc.h
@@ -864,7 +864,7 @@ typedef struct {
  * Initialize RTC clock and power control related functions
  * @param cfg configuration options as rtc_config_t
  */
-void rtc_init(rtc_config_t cfg);
+void rtc_init_module(rtc_config_t cfg);
 
 /**
  * Structure describing vddsdio configuration
-- 
2.37.2

